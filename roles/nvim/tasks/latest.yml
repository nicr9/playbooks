---
- name: determine which version is the latest
  block:
  - github_release:
      user: neovim
      repo: neovim
      action: latest_release
    register: neovim
  - set_fact:
      nvim_version: "{{ neovim.tag }}"
  when: nvim_version in ['', 'latest']

- name: Download release, unarchive into /tmp/nvim
  become: yes
  unarchive:
    src: "https://github.com/neovim/neovim/releases/download/{{ nvim_version }}/nvim-linux-x86_64.tar.gz"
    extra_opts:
    - --strip-components=1
    dest: "/usr/"
    owner: root
    group: root
    remote_src: yes
